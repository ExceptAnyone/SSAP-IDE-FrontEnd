{"ast":null,"code":"var _jsxFileName = \"/Users/seongsuk/SSAP-IDE-FrontEnd/front/src/components/chat/Chat.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from \"react\";\nimport socketIOClient from \"socket.io-client\";\nimport { API_ENDPOINT, getMessages, sendMessage } from \"../../api/chatAPI\";\nimport { IoIosCloseCircleOutline } from \"react-icons/io\";\nimport { BiSearch, BiSolidUser } from \"react-icons/bi\";\nimport { BsChatSquareDots } from \"react-icons/bs\";\nimport \"./chat.scss\";\nimport ChatUserList from \"./chatUserList/ChatUserList\";\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\n\n// TODO 컨테이너 고유ID를 roomID로 적용시켜야함\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst roomId = \"aa0cea7dcd81cbea0fe690aa72b8520b6dfce49e35e418c0a0c32f88f24a105\";\n// const user = { email: \"mater@gmail.com\", name: \"master\" };\n// ssap@naver.com ssap1234!\n\nconst Chat = () => {\n  _s();\n  const user = JSON.parse(localStorage.getItem(\"chatUser\"));\n  console.log(\"chatUser\", user);\n  const name = user.name;\n  const email = user.email;\n\n  // const [users, setUsers] = useState([]);\n  // const [userName, setUserName] = useState(user.name);\n  // const [userEmail, setUserEmail] = useState(user.name);\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const socketRef = useRef();\n  const [isVisible, setIsVisible] = useState(false);\n  const [newMessageArrived, setNewMessageArrived] = useState(false);\n  const [showUserList, setShowUserList] = useState(false);\n  const queryClient = useQueryClient();\n  const {\n    data: chatData,\n    isLoading,\n    isError\n  } = useQuery([\"getMessages\", roomId],\n  // 쿼리 키\n  () => getMessages(roomId),\n  // 데이터를 가져오는 함수\n  {\n    enabled: !!roomId,\n    // roomId가 존재할 때만 활성화\n    onSuccess: data => {\n      setMessages(data);\n    },\n    retry: 3,\n    // 실패 시 최대 3번 재시도\n    retryDelay: attempt => Math.min(attempt * 1000, 3000) // 재시도 사이의 지연 시간 설정\n  });\n  // console.log(\"getMessages\", chatData);\n\n  //TODO\n  const sendMessageMutation = useMutation(sendMessage, {\n    onSuccess: data => {\n      // 메시지 전송에 성공하면 데이터를 재요청\n      queryClient.invalidateQueries([\"getMessages\", roomId]);\n      console.log(\"메세지 저장 성공:\", data);\n    },\n    onError: error => {\n      console.error(\"메세지 저장 실패:\", error);\n    }\n  });\n\n  // 소켓\n  useEffect(() => {\n    if (!email) return;\n\n    // Socket.IO 클라이언트 초기화\n    const socket = socketIOClient(API_ENDPOINT, {\n      //cors 체크\n      withCredentials: true\n    });\n    socket.emit(\"setUserInfo\", {\n      email: email,\n      name: name\n    });\n    console.log(\"setUserInfo: \", email, name);\n    socket.emit(\"joinRoom\", roomId, email);\n\n    // 서버로부터 메시지를 받으면 상태 업데이트\n    const onReceiveMessage = data => {\n      const {\n        name,\n        message\n      } = data;\n      setMessages(prevMessages => [...prevMessages, {\n        name,\n        message\n      }]);\n\n      // 본인 확인\n      const isOwner = data.email === email;\n      console.log(\"data.email:\", data.email, \"userEmail\", email);\n      console.log(\"isOwner:\", isOwner, \"isVisible:\", isVisible);\n\n      // 새로운 메세지 도착하면 알림\n      if (!isOwner && !isVisibleRef.current) {\n        setNewMessageArrived(true);\n        queryClient.invalidateQueries(\"getMessages\"); // 새로운 메세지 도착시 채팅 내용 가져오기\n      }\n    };\n\n    socket.on(\"receiveMessage\", data => {\n      onReceiveMessage(data);\n      queryClient.invalidateQueries(\"getMessages\");\n    }); // TODO: 수정됨\n\n    socketRef.current = socket;\n\n    // 소켓 연결 종료\n    return () => {\n      socket.off(\"receiveMessage\", onReceiveMessage);\n      socketRef.current.disconnect();\n    };\n  }, [roomId, email, name]);\n\n  // 메세지 엡뎃 확인용\n  useEffect(() => {\n    console.log(\"Updated messages:\", messages, \"UpdatednewMessageArrived:\", newMessageArrived);\n  }, [messages, newMessageArrived]);\n\n  // 채팅창 열기\n  const handleToggleChat = () => {\n    setNewMessageArrived(false);\n    setIsVisible(prevIsVisible => !prevIsVisible); // isVisible 상태 토글\n  };\n\n  // 채팅 메세지 전송\n  const handleSendMessage = async e => {\n    if (e) e.preventDefault();\n    if (message.trim() === \"\") return;\n    const data = {\n      email,\n      name,\n      message\n    };\n    console.log(\"handleSendMessage: \", data);\n    try {\n      const result = await sendMessageMutation.mutateAsync(data);\n      if (result.success) {\n        setMessage(\"\");\n      }\n    } catch (error) {\n      console.error(\"메세지 전송 오류:\", error);\n    }\n  };\n\n  // textarea 엔터 키 전송\n  const handleTextareaKeyPress = e => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  // 채팅창 열림 여부 최신 상태 업뎃 유지\n  const isVisibleRef = useRef(isVisible);\n  useEffect(() => {\n    isVisibleRef.current = isVisible;\n    console.log(\"isVisible:\", isVisible); // isVisible 상태 확인용\n  }, [isVisible]);\n\n  // 접속자 창 toggle\n  const toggleUserList = () => {\n    setShowUserList(prev => !prev);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat_container\",\n    children: [isVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-inner\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-content\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-top\",\n          children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n            children: \"\\uCC44\\uD305\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"top_right\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: /*#__PURE__*/_jsxDEV(BiSearch, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 176,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              onClick: toggleUserList,\n              children: [/*#__PURE__*/_jsxDEV(BiSolidUser, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 180,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(PersonIcon, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 182,\n                columnNumber: 9\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"msg-wrap\",\n          children: messages.map((msg, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n            className: `message ${msg.email === email ? \"msg_right\" : \"msg_left\"}`,\n            children: [msg.email === email ? \"\" : /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: msg.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 194,\n              columnNumber: 47\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: msg.message\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 196,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"msg-form\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            onSubmit: handleSendMessage,\n            children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n              value: message,\n              autoFocus: true,\n              onChange: e => setMessage(e.target.value),\n              onKeyPress: handleTextareaKeyPress\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              children: \"\\uC804\\uC1A1\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 208,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 11\n      }, this), showUserList && /*#__PURE__*/_jsxDEV(ChatUserList, {\n        userName: name\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 28\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      className: `chat-button ${isVisible ? \"close\" : \"open\"} ${newMessageArrived && \"bounce-animation\"}`,\n      onClick: handleToggleChat,\n      children: [isVisible ? /*#__PURE__*/_jsxDEV(IoIosCloseCircleOutline, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 22\n      }, this) : /*#__PURE__*/_jsxDEV(BsChatSquareDots, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 52\n      }, this), newMessageArrived && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"notification\",\n        children: \"!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 31\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 169,\n    columnNumber: 5\n  }, this);\n};\n_s(Chat, \"EkoR1NBwgZYWA9B5wwy/8lO57Hk=\", false, function () {\n  return [useQueryClient, useQuery, useMutation];\n});\n_c = Chat;\nexport default Chat;\nvar _c;\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"names":["React","useState","useEffect","useRef","socketIOClient","API_ENDPOINT","getMessages","sendMessage","IoIosCloseCircleOutline","BiSearch","BiSolidUser","BsChatSquareDots","ChatUserList","useMutation","useQuery","useQueryClient","jsxDEV","_jsxDEV","roomId","Chat","_s","user","JSON","parse","localStorage","getItem","console","log","name","email","messages","setMessages","message","setMessage","socketRef","isVisible","setIsVisible","newMessageArrived","setNewMessageArrived","showUserList","setShowUserList","queryClient","data","chatData","isLoading","isError","enabled","onSuccess","retry","retryDelay","attempt","Math","min","sendMessageMutation","invalidateQueries","onError","error","socket","withCredentials","emit","onReceiveMessage","prevMessages","isOwner","isVisibleRef","current","on","off","disconnect","handleToggleChat","prevIsVisible","handleSendMessage","e","preventDefault","trim","result","mutateAsync","success","handleTextareaKeyPress","key","shiftKey","toggleUserList","prev","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","PersonIcon","map","msg","index","onSubmit","value","autoFocus","onChange","target","onKeyPress","type","userName","_c","$RefreshReg$"],"sources":["/Users/seongsuk/SSAP-IDE-FrontEnd/front/src/components/chat/Chat.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport socketIOClient from \"socket.io-client\";\nimport { API_ENDPOINT, getMessages, sendMessage } from \"../../api/chatAPI\";\nimport { IoIosCloseCircleOutline } from \"react-icons/io\";\nimport { BiSearch, BiSolidUser } from \"react-icons/bi\";\nimport { BsChatSquareDots } from \"react-icons/bs\";\nimport \"./chat.scss\";\nimport ChatUserList from \"./chatUserList/ChatUserList\";\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\n\n// TODO 컨테이너 고유ID를 roomID로 적용시켜야함\nconst roomId =\n  \"aa0cea7dcd81cbea0fe690aa72b8520b6dfce49e35e418c0a0c32f88f24a105\";\n// const user = { email: \"mater@gmail.com\", name: \"master\" };\n// ssap@naver.com ssap1234!\n\nconst Chat = () => {\n  const user = JSON.parse(localStorage.getItem(\"chatUser\"));\n  console.log(\"chatUser\", user);\n  const name = user.name;\n  const email = user.email;\n\n  // const [users, setUsers] = useState([]);\n  // const [userName, setUserName] = useState(user.name);\n  // const [userEmail, setUserEmail] = useState(user.name);\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const socketRef = useRef();\n\n  const [isVisible, setIsVisible] = useState(false);\n  const [newMessageArrived, setNewMessageArrived] = useState(false);\n  const [showUserList, setShowUserList] = useState(false);\n\n  const queryClient = useQueryClient();\n  const {\n    data: chatData,\n    isLoading,\n    isError,\n  } = useQuery(\n    [\"getMessages\", roomId], // 쿼리 키\n    () => getMessages(roomId), // 데이터를 가져오는 함수\n    {\n      enabled: !!roomId, // roomId가 존재할 때만 활성화\n      onSuccess: (data) => {\n        setMessages(data);\n      },\n      retry: 3, // 실패 시 최대 3번 재시도\n      retryDelay: (attempt) => Math.min(attempt * 1000, 3000), // 재시도 사이의 지연 시간 설정\n    },\n  );\n  // console.log(\"getMessages\", chatData);\n\n  //TODO\n  const sendMessageMutation = useMutation(sendMessage, {\n    onSuccess: (data) => {\n      // 메시지 전송에 성공하면 데이터를 재요청\n      queryClient.invalidateQueries([\"getMessages\", roomId]);\n      console.log(\"메세지 저장 성공:\", data);\n    },\n    onError: (error) => {\n      console.error(\"메세지 저장 실패:\", error);\n    },\n  });\n\n  // 소켓\n  useEffect(() => {\n    if (!email) return;\n\n    // Socket.IO 클라이언트 초기화\n    const socket = socketIOClient(API_ENDPOINT, {\n      //cors 체크\n      withCredentials: true,\n    });\n\n    socket.emit(\"setUserInfo\", {\n      email: email,\n      name: name,\n    });\n    console.log(\"setUserInfo: \", email, name);\n\n    socket.emit(\"joinRoom\", roomId, email);\n\n    // 서버로부터 메시지를 받으면 상태 업데이트\n    const onReceiveMessage = (data) => {\n      const { name, message } = data;\n      setMessages((prevMessages) => [...prevMessages, { name, message }]);\n\n      // 본인 확인\n      const isOwner = data.email === email;\n      console.log(\"data.email:\", data.email, \"userEmail\", email);\n      console.log(\"isOwner:\", isOwner, \"isVisible:\", isVisible);\n\n      // 새로운 메세지 도착하면 알림\n      if (!isOwner && !isVisibleRef.current) {\n        setNewMessageArrived(true);\n        queryClient.invalidateQueries(\"getMessages\"); // 새로운 메세지 도착시 채팅 내용 가져오기\n      }\n    };\n\n    socket.on(\"receiveMessage\", (data) => {\n      onReceiveMessage(data);\n      queryClient.invalidateQueries(\"getMessages\");\n    }); // TODO: 수정됨\n\n    socketRef.current = socket;\n\n    // 소켓 연결 종료\n    return () => {\n      socket.off(\"receiveMessage\", onReceiveMessage);\n      socketRef.current.disconnect();\n    };\n  }, [roomId, email, name]);\n\n  // 메세지 엡뎃 확인용\n  useEffect(() => {\n    console.log(\n      \"Updated messages:\",\n      messages,\n      \"UpdatednewMessageArrived:\",\n      newMessageArrived,\n    );\n  }, [messages, newMessageArrived]);\n\n  // 채팅창 열기\n  const handleToggleChat = () => {\n    setNewMessageArrived(false);\n    setIsVisible((prevIsVisible) => !prevIsVisible); // isVisible 상태 토글\n  };\n\n  // 채팅 메세지 전송\n  const handleSendMessage = async (e) => {\n    if (e) e.preventDefault();\n    if (message.trim() === \"\") return;\n\n    const data = { email, name, message };\n    console.log(\"handleSendMessage: \", data);\n\n    try {\n      const result = await sendMessageMutation.mutateAsync(data);\n      if (result.success) {\n        setMessage(\"\");\n      }\n    } catch (error) {\n      console.error(\"메세지 전송 오류:\", error);\n    }\n  };\n\n  // textarea 엔터 키 전송\n  const handleTextareaKeyPress = (e) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  // 채팅창 열림 여부 최신 상태 업뎃 유지\n  const isVisibleRef = useRef(isVisible);\n  useEffect(() => {\n    isVisibleRef.current = isVisible;\n    console.log(\"isVisible:\", isVisible); // isVisible 상태 확인용\n  }, [isVisible]);\n\n  // 접속자 창 toggle\n  const toggleUserList = () => {\n    setShowUserList((prev) => !prev);\n  };\n\n  return (\n    <div className=\"chat_container\">\n      {isVisible && (\n        <div className=\"chat-inner\">\n          <div className=\"chat-content\">\n            <div className=\"chat-top\">\n              <h4>채팅</h4>\n              <div className=\"top_right\">\n                <span>\n                  <BiSearch />\n                </span>\n                <span onClick={toggleUserList}>\n                  <BiSolidUser />\n\n        <PersonIcon />\n                </span>\n              </div>\n            </div>\n            <div className=\"msg-wrap\">\n              {messages.map((msg, index) => (\n                <div\n                  key={index}\n                  className={`message ${\n                    msg.email === email ? \"msg_right\" : \"msg_left\"\n                  }`}\n                >\n                  {msg.email === email ? \"\" : <strong>{msg.name}</strong>}\n\n                  <span>{msg.message}</span>\n                </div>\n              ))}\n            </div>\n            <div className=\"msg-form\">\n              <form onSubmit={handleSendMessage}>\n                <textarea\n                  value={message}\n                  autoFocus={true}\n                  onChange={(e) => setMessage(e.target.value)}\n                  onKeyPress={handleTextareaKeyPress}\n                ></textarea>\n                <button type=\"submit\">전송</button>\n              </form>\n            </div>\n          </div>\n          {showUserList && <ChatUserList userName={name} />}\n        </div>\n      )}\n      {/* TODO: 알림 애니메이션 수정 필요 */}\n      <button\n        className={`chat-button ${isVisible ? \"close\" : \"open\"} ${\n          newMessageArrived && \"bounce-animation\"\n        }`}\n        onClick={handleToggleChat}\n      >\n        {isVisible ? <IoIosCloseCircleOutline /> : <BsChatSquareDots />}\n        {newMessageArrived && <span className=\"notification\">!</span>}\n      </button>\n    </div>\n  );\n};\n\nexport default Chat;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}